/*6edd7ea282e39457dabfb4aa1ae46a65613def1a*/Ext.define("SyncLists.model.SyncedList",{extend:"Ext.data.Model",config:{fields:[{name:"name",type:"string"},],identifier:"sequential",proxy:{type:"localstorage",id:"SyncedLists"}}});SyncLists.model.SyncedList.offlineStore=Ext.create("Ext.data.Store",{model:"SyncLists.model.SyncedList",storeId:"SyncedList-offline",autoLoad:true,});Ext.define("SyncLists.model.ListItem",{extend:"Ext.data.Model",config:{fields:[{name:"name",type:"string"},{name:"syncedlist_id",type:"string"},{name:"checked",type:"boolean",defaultValue:false}],associations:[{type:"belongsTo",model:"SyncedList"}],identifier:"sequential",proxy:{type:"localstorage",id:"ListItems"}}});SyncLists.model.SyncedList.offlineStore=Ext.create("Ext.data.Store",{model:"SyncLists.model.ListItem",storeId:"ListItem-offline",autoLoad:true,sorters:[{property:"checked",direction:"ASC"},{property:"name",direction:"ASC"}]});Ext.define("SyncLists.view.NavigationView",{extend:"Ext.navigation.View",xtype:"NavigationView",config:{navigationBar:{docked:"top"}},rightButton:{xtype:"button",iconMask:true,iconCls:"refresh",align:"right",action:"refresh"},leftButton:{xtype:"button",iconMask:true,iconCls:"info",ui:"plain",align:"left",action:"showInfo"},initialize:function(){this.callParent(arguments);this.addBeforeListener("activeitemchange",this.updateViewButtons);this.updateViewButtons(this,this.getActiveItem())},updateViewButtons:function(b,d,h,a){var e=this.getNavigationBar();if(!d){return}if(e){e.rightBox.removeAll();for(var f=0;f<e.leftBox.items.items.length;f++){var c=e.leftBox.items.items[f];if(c._ui!="back"){e.leftBox.remove(c,true)}}var g=d.config.rightButton;if(g){e.add(g)}var j=d.config.leftButton;if(j){e.add(j)}}}});Ext.define("SyncLists.view.Main",{extend:"SyncLists.view.NavigationView",xtype:"navView",requires:["Ext.TitleBar"],config:{items:[{xtype:"ListsView"}]}});Ext.define("SyncLists.view.ListsView",{extend:"Ext.Container",xtype:"ListsView",requires:["Ext.dataview.List"],config:{title:"Lists",layout:"fit",items:[{xtype:"list",scrollable:true,itemTpl:"{name}",store:Ext.getStore("SyncedList-offline"),listeners:{itemtap:function(b,a,c,d){setTimeout(function(){b.deselect(a)},200)}}},{xtype:"toolbar",docked:"bottom",layout:{pack:"center"},items:[{xtype:"button",text:"sync",disabled:true,action:"sync"}]}],rightButton:{xtype:"button",iconMask:true,iconCls:"add",align:"right",action:"addList"}}});Ext.define("SyncLists.view.ListItemsView",{extend:"Ext.Container",xtype:"ListItemsView",requires:["Ext.dataview.List"],config:{title:"List",layout:"fit",items:[{xtype:"list",scrollable:true,itemTpl:new Ext.XTemplate('<input type="checkbox" <tpl if="checked">checked</tpl> disabled/>{name}'),listeners:{itemtap:function(b,a,c,d){setTimeout(function(){b.deselect(a)},100)}}},{xtype:"toolbar",docked:"bottom",items:[{xtype:"button",disabled:true,text:"sort",action:"sort"},{xtype:"button",disabled:true,text:"sync",action:"syncThisList"},{xtype:"button",disabled:true,text:"share",action:"share",align:"right"}]}],rightButton:{xtype:"button",iconMask:true,iconCls:"add",align:"right",action:"addItem"}}});Ext.define("SyncLists.controller.ListsVC",{extend:"Ext.app.Controller",config:{refs:{navView:"navView",listView:"ListsView list"},control:{listView:{itemtap:"showListItems"},"button[action=sync]":{tap:"sync"},"button[action=addList]":{tap:"add"}}},offlineStore:Ext.getStore("SyncedList-offline"),itemsVC:null,launch:function(a){this.itemsVC=this.getApplication().getController("ListItemsVC")},sync:function(){console.log("sync!")},add:function(){var a=this;Ext.Msg.prompt("New List","Please enter the lists name:",function(b,d){if(b=="ok"){var c=Ext.create("SyncLists.model.SyncedList",{name:d});c.save();a.offlineStore.load()}})},showListItems:function(e,c,d,b){var a=Ext.create("SyncLists.view.ListItemsView",{record:b,title:b.get("name")});this.itemsVC.currentList=b;var f=Ext.getStore("ListItem-offline");f.setFilters([new Ext.util.Filter({property:"syncedlist_id",value:b.id})]);a.down("list").setStore(f);this.getNavView().push(a)}});Ext.define("SyncLists.controller.ListItemsVC",{extend:"Ext.app.Controller",xtype:"ListItemsVC",config:{refs:{navView:"navView",listView:"ListItemsView list"},control:{listView:{itemtap:"showListItems"},"button[action=syncThisList]":{tap:"sync"},"button[action=addItem]":{tap:"add"}}},offlineStore:Ext.getStore("ListItem-offline"),currentList:null,launch:function(a){},sync:function(){console.log("sync!",this.currentList)},add:function(){var a=this;Ext.Msg.prompt("New Item","Please enter the items name:",function(b,d){if(b=="ok"){var c=Ext.create("SyncLists.model.ListItem",{name:d});c.set("syncedlist_id",a.currentList.id);c.save();a.offlineStore.load()}})},showListItems:function(d,b,c,a){console.log("tap!",arguments);c.down("input[type=checkbox]").dom.checked=!a.data.checked;a.set("checked",!a.data.checked);a.save()}});Ext.application({name:"SyncLists",requires:["Ext.MessageBox"],models:["SyncedList","ListItem"],views:["NavigationView","Main","ListsView","ListItemsView"],controllers:["ListsVC","ListItemsVC"],icon:{"57":"resources/icons/Icon.png","72":"resources/icons/Icon~ipad.png","114":"resources/icons/Icon@2x.png","144":"resources/icons/Icon~ipad@2x.png"},isIconPrecomposed:true,startupImage:{"320x460":"resources/startup/320x460.jpg","640x920":"resources/startup/640x920.png","768x1004":"resources/startup/768x1004.png","748x1024":"resources/startup/748x1024.png","1536x2008":"resources/startup/1536x2008.png","1496x2048":"resources/startup/1496x2048.png"},launch:function(){Ext.fly("appLoadingIndicator").destroy();Ext.Viewport.add(Ext.create("SyncLists.view.Main"))},onUpdated:function(){Ext.Msg.confirm("Application Update","This application has just successfully been updated to the latest version. Reload now?",function(a){if(a==="yes"){window.location.reload()}})}});